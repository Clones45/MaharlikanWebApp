<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self' 'unsafe-inline' data: blob: filesystem:;
               img-src 'self' data: blob: file:;
               style-src 'self' 'unsafe-inline';
               script-src 'self' 'unsafe-inline' https://unpkg.com https://cdn.jsdelivr.net;
               connect-src 'self' https://*.supabase.co https://*.supabase.in https://api.supabase.com blob:;"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Maharlikan Admin Login</title>
    <link rel="stylesheet" href="./styles.css" />

    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script>
      const { createClient } = supabase;
      const supabaseUrl = "https://agyueadcymdopgihtckc.supabase.co";
      const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFneXVlYWRjeW1kb3BnaWh0Y2tjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkzMzA2NjYsImV4cCI6MjA3NDkwNjY2Nn0.EBYfJ9RTkeGLQptG3uWaOsFMIz9DySu3uhaOlzgeeMw";
      const db = createClient(supabaseUrl, supabaseKey);

      async function login() {
        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value.trim();
        const msg = document.getElementById("loginMsg");
        msg.textContent = "Signing in...";

        const { data, error } = await db.auth.signInWithPassword({
          email,
          password,
        });

        if (error) {
          msg.textContent = "Invalid login credentials.";
          msg.style.color = "red";
        } else {
          msg.textContent = "Login successful! Redirecting...";
          msg.style.color = "limegreen";
          setTimeout(() => (window.location.href = "index.html"), 1200);
        }
      }
    </script>
  </head>

<body>
    <div id="login-section" class="split-layout">
      <section class="login-panel">
        <div class="login-card">
          <h2>Admin Login</h2>

          <label for="email">Username</label>
          <input id="email" type="text" placeholder="Enter username" />

          <label for="password">Password</label>
          <input id="password" type="password" placeholder="Enter password" />

          <div class="row">
            <label class="remember">
              <input id="remember" type="checkbox" /> Remember me
            </label>
          </div>

          <button id="loginBtn" type="button" class="primary">Sign In</button>
          <p id="loginMsg" class="muted" aria-live="polite"></p>
        </div>
      </section>

      <section class="brand-panel">
        <h1 class="brand-title">Maharlikan AssuredLife</h1>
        <p class="brand-sub">
          Layunin ng Maharlikan AssuredLife ay <b>ASSURED</b> ka!
        </p>
      </section>
    </div>

    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="./app.js"></script>
  </body>
</html>
